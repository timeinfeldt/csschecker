#!/usr/bin/env php
<?php

use csschecker\CssChecker;
use csschecker\reports\CheckstyleReport;
use csschecker\reports\CompositeReport;
use csschecker\reports\FileReport;
use csschecker\reports\Report;

// dev & installed autoloading
$files = array(
    __DIR__ . '/vendor/autoload.php',
    __DIR__ . '/../../autoload.php'
);
foreach ($files as $file) {
    if (file_exists($file)) {
        require $file;
        break;
    }
}

$checks = array(
    /*
    'MultipleDefinitionsCheck' => array(
        'maxDefinitions' => 10
    ),
    */
    'SelectorLengthCheck' => array(
        'maxSelectorLength' => 4
    ),
    //'NoUsageCheck' => array(),
    'RuleUsageCheck' => array(),
    //'FileDeclarationsCountCheck' => array(),
    //'FileSizeCheck' => array(),
    'ClassLengthCheck' => array(
        'maxClassLength' => 40
    )
);

$args = $_SERVER['argv'];
unset($args[0]);

$checker = new CssChecker;
$report = new CompositeReport(array(
    new FileReport(fopen('php://stdout', 'w')),
    new FileReport(fopen(__DIR__ . '/result.txt', 'w')),
    new CheckstyleReport(__DIR__ . '/checkstyle.xml')
));

$checker->runChecks($args, $checks, $report);

